<svg width="800" height="500" xmlns="http://www.w3.org/2000/svg">
  <!-- Title -->
  <text x="400" y="30" font-family="Arial, sans-serif" font-size="20" font-weight="bold" text-anchor="middle" fill="#2c3e50">
    Verified MLP Architecture (784 → 128 → 10)
  </text>

  <!-- Input Layer -->
  <g id="input-layer">
    <rect x="50" y="100" width="120" height="280" rx="8" fill="#ecf0f1" stroke="#34495e" stroke-width="2"/>
    <text x="110" y="130" font-family="monospace" font-size="14" font-weight="bold" text-anchor="middle" fill="#2c3e50">Input</text>
    <text x="110" y="155" font-family="monospace" font-size="13" text-anchor="middle" fill="#34495e">784 neurons</text>
    <text x="110" y="180" font-family="monospace" font-size="12" text-anchor="middle" fill="#7f8c8d">(28×28 pixels)</text>

    <!-- Visual representation of neurons -->
    <circle cx="80" cy="210" r="6" fill="#3498db"/>
    <circle cx="110" cy="210" r="6" fill="#3498db"/>
    <circle cx="140" cy="210" r="6" fill="#3498db"/>
    <circle cx="80" cy="240" r="6" fill="#3498db"/>
    <circle cx="110" cy="240" r="6" fill="#3498db"/>
    <circle cx="140" cy="240" r="6" fill="#3498db"/>
    <circle cx="80" cy="270" r="6" fill="#3498db"/>
    <circle cx="110" cy="270" r="6" fill="#3498db"/>
    <circle cx="140" cy="270" r="6" fill="#3498db"/>
    <text x="110" y="310" font-family="monospace" font-size="11" text-anchor="middle" fill="#95a5a6">⋮</text>
  </g>

  <!-- Arrow 1: Input -> Hidden -->
  <g id="arrow1">
    <path d="M 170 240 L 260 240" stroke="#e74c3c" stroke-width="3" fill="none" marker-end="url(#arrowhead)"/>
    <text x="215" y="230" font-family="monospace" font-size="12" text-anchor="middle" fill="#e74c3c">W₁[128,784]</text>
    <text x="215" y="265" font-family="monospace" font-size="11" text-anchor="middle" fill="#c0392b">+ b₁[128]</text>
  </g>

  <!-- Hidden Layer -->
  <g id="hidden-layer">
    <rect x="260" y="100" width="120" height="280" rx="8" fill="#ecf0f1" stroke="#34495e" stroke-width="2"/>
    <text x="320" y="130" font-family="monospace" font-size="14" font-weight="bold" text-anchor="middle" fill="#2c3e50">Hidden</text>
    <text x="320" y="155" font-family="monospace" font-size="13" text-anchor="middle" fill="#34495e">128 neurons</text>
    <text x="320" y="180" font-family="monospace" font-size="12" text-anchor="middle" fill="#e74c3c">ReLU(x)</text>

    <!-- Visual representation of neurons -->
    <circle cx="290" cy="210" r="6" fill="#e67e22"/>
    <circle cx="320" cy="210" r="6" fill="#e67e22"/>
    <circle cx="350" cy="210" r="6" fill="#e67e22"/>
    <circle cx="290" cy="240" r="6" fill="#e67e22"/>
    <circle cx="320" cy="240" r="6" fill="#e67e22"/>
    <circle cx="350" cy="240" r="6" fill="#e67e22"/>
    <circle cx="290" cy="270" r="6" fill="#e67e22"/>
    <circle cx="320" cy="270" r="6" fill="#e67e22"/>
    <circle cx="350" cy="270" r="6" fill="#e67e22"/>
    <text x="320" y="310" font-family="monospace" font-size="11" text-anchor="middle" fill="#95a5a6">⋮</text>
  </g>

  <!-- Arrow 2: Hidden -> Output -->
  <g id="arrow2">
    <path d="M 380 240 L 470 240" stroke="#e74c3c" stroke-width="3" fill="none" marker-end="url(#arrowhead)"/>
    <text x="425" y="230" font-family="monospace" font-size="12" text-anchor="middle" fill="#e74c3c">W₂[10,128]</text>
    <text x="425" y="265" font-family="monospace" font-size="11" text-anchor="middle" fill="#c0392b">+ b₂[10]</text>
  </g>

  <!-- Output Layer -->
  <g id="output-layer">
    <rect x="470" y="100" width="120" height="280" rx="8" fill="#ecf0f1" stroke="#34495e" stroke-width="2"/>
    <text x="530" y="130" font-family="monospace" font-size="14" font-weight="bold" text-anchor="middle" fill="#2c3e50">Output</text>
    <text x="530" y="155" font-family="monospace" font-size="13" text-anchor="middle" fill="#34495e">10 neurons</text>
    <text x="530" y="180" font-family="monospace" font-size="12" text-anchor="middle" fill="#9b59b6">Softmax</text>

    <!-- Visual representation of neurons with labels -->
    <circle cx="500" cy="210" r="6" fill="#9b59b6"/>
    <text x="520" y="214" font-family="monospace" font-size="10" fill="#7f8c8d">0</text>
    <circle cx="500" cy="235" r="6" fill="#9b59b6"/>
    <text x="520" y="239" font-family="monospace" font-size="10" fill="#7f8c8d">1</text>
    <circle cx="500" cy="260" r="6" fill="#9b59b6"/>
    <text x="520" y="264" font-family="monospace" font-size="10" fill="#7f8c8d">2</text>
    <text x="530" y="290" font-family="monospace" font-size="11" text-anchor="middle" fill="#95a5a6">⋮</text>
    <circle cx="500" cy="320" r="6" fill="#9b59b6"/>
    <text x="520" y="324" font-family="monospace" font-size="10" fill="#7f8c8d">9</text>
  </g>

  <!-- Loss Function -->
  <g id="loss">
    <rect x="630" y="180" width="140" height="80" rx="8" fill="#fff5f5" stroke="#e74c3c" stroke-width="2" stroke-dasharray="4,4"/>
    <text x="700" y="210" font-family="monospace" font-size="13" font-weight="bold" text-anchor="middle" fill="#c0392b">Cross-Entropy</text>
    <text x="700" y="230" font-family="monospace" font-size="11" text-anchor="middle" fill="#7f8c8d">Loss Function</text>
  </g>

  <!-- Arrow to loss -->
  <path d="M 590 240 L 630 220" stroke="#95a5a6" stroke-width="2" fill="none" marker-end="url(#arrowhead-gray)"/>

  <!-- Backpropagation arrows (dashed, going backward) -->
  <g id="backprop">
    <path d="M 460 280 L 390 280" stroke="#27ae60" stroke-width="2" stroke-dasharray="5,5" fill="none" marker-end="url(#arrowhead-green)"/>
    <path d="M 250 280 L 180 280" stroke="#27ae60" stroke-width="2" stroke-dasharray="5,5" fill="none" marker-end="url(#arrowhead-green)"/>
    <text x="400" y="450" font-family="monospace" font-size="13" text-anchor="middle" fill="#27ae60">← Gradient Flow (Backpropagation)</text>
  </g>

  <!-- Legend -->
  <g id="legend">
    <text x="50" y="430" font-family="monospace" font-size="12" font-weight="bold" fill="#2c3e50">Total Parameters:</text>
    <text x="50" y="450" font-family="monospace" font-size="11" fill="#34495e">W₁: 100,352 | b₁: 128 | W₂: 1,280 | b₂: 10</text>
    <text x="50" y="470" font-family="monospace" font-size="12" font-weight="bold" fill="#2c3e50">Total: 101,770 parameters</text>
  </g>

  <!-- Arrow markers -->
  <defs>
    <marker id="arrowhead" markerWidth="10" markerHeight="10" refX="9" refY="3" orient="auto">
      <polygon points="0 0, 10 3, 0 6" fill="#e74c3c"/>
    </marker>
    <marker id="arrowhead-gray" markerWidth="10" markerHeight="10" refX="9" refY="3" orient="auto">
      <polygon points="0 0, 10 3, 0 6" fill="#95a5a6"/>
    </marker>
    <marker id="arrowhead-green" markerWidth="10" markerHeight="10" refX="9" refY="3" orient="auto">
      <polygon points="0 0, 10 3, 0 6" fill="#27ae60"/>
    </marker>
  </defs>
</svg>
